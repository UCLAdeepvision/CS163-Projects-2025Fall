<!DOCTYPE html>
<html lang="en">

  <head>
    
      






    

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>From Paris to Seychelles - Deep Learning Techniques for Global Image Geolocation</title>

    <meta name="description" content="This block is a brief introduction of your project. You can put your abstract here or any headers you want the readers to know.">

    <meta content="2025F, UCLA CS163 Course Projects" property="og:site_name">
    
        <meta content="From Paris to Seychelles - Deep Learning Techniques for Global Image Geolocation" property="og:title">
    
    
        <meta content="article" property="og:type">
    
    
        <meta content="This block is a brief introduction of your project. You can put your abstract here or any headers you want the readers to know." property="og:description">
    
    
        <meta content="http://localhost:4000/2025/12/12/team19-instruction-to-post.html" property="og:url">
    
<!--
    
        <meta content="Shelby Falde, Joshua Li, Alexander Chen" property="article:author">
        <meta content="http://localhost:4000/about/" property="article:author">
     -->

    <!-- 
        <meta content="2025-12-12T00:00:00-08:00" property="article:published_time">
        <meta content="http://localhost:4000/about/" property="article:author">
    
    
    
        
     -->

    <link rel="shortcut icon" href="/CS163-Projects-2025Fall/assets/ucla_ico.jpg">
    <link rel="stylesheet" href="/CS163-Projects-2025Fall/assets/css/main.css">
    <link rel="canonical" href="http://localhost:4000/CS163-Projects-2025Fall/2025/12/12/team19-instruction-to-post.html">

    <!-- For Latex -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

    <!-- Google Analytics -->
    <!-- <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-8161570-6', 'auto');
        ga('send', 'pageview');
    </script> -->

    <!-- For Facebook share button -->
    <!-- <div id="fb-root"></div>
    <script>
      (function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.9";
        fjs.parentNode.insertBefore(js, fjs);
      }(document, 'script', 'facebook-jssdk'));
    </script> -->

    <!-- Twitter cards -->
    <!-- <meta name="twitter:site"    content="@">
    <meta name="twitter:creator" content="@UCLAdeepvision">
    <meta name="twitter:title"   content="From Paris to Seychelles - Deep Learning Techniques for Global Image Geolocation">

    
        <meta name="twitter:description" content="<blockquote>
  <p>This block is a brief introduction of your project. You can put your abstract here or any headers you want the readers to know.</p>
</blockquote>

">
    

    
        <meta name="twitter:card"  content="summary">
        <meta name="twitter:image" content="">
     -->
    <!-- end of Twitter cards -->

</head>


  <body>

    <header class="site-header" role="banner" id='header-bar'>

    <div class="wrapper">
        
        <a class="site-title" style="color:#F2A900" href="/CS163-Projects-2025Fall/">2025F, UCLA CS163 Course Projects  </a>

        <!-- <nav class="site-nav">
            <a class="page-link" href="http://lilianweng.github.io" target="_blank">&#x1f349; About</a>
        </nav> -->
        <nav class="site-nav">
            <a class="page-link" style="color:#F2A900" href="/CS163-Projects-2025Fall/about.html"> About</a>
        </nav>

        <nav class="site-nav">
            <a class="page-link" style="color:#F2A900" href="/CS163-Projects-2025Fall/archive.html"> Archive</a>
        </nav>


        <!-- <nav class="site-nav">
            <a class="page-link" style="color:#FFD100" href="/CS163-Projects-2025Fall/FAQ.html"> FAQ</a>
        </nav> -->
        <!-- <nav class="site-nav">
            <a class="page-link" href="/CS163-Projects-2025Fall/log.html">&#x231b; Log</a>
        </nav> -->


    </div>

</header>


    <!-- Back to top button -->
    <script src="/CS163-Projects-2025Fall/assets/vanilla-back-to-top.min.js"></script>
    <script>addBackToTop()</script>

    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">From Paris to Seychelles - Deep Learning Techniques for Global Image Geolocation</h1>
    <p class="post-meta">

      <time datetime="2025-12-12T00:00:00-08:00" itemprop="datePublished">
        
        Dec 12, 2025
      </time>

      <span itemprop="author" itemscope itemtype="http://schema.org/Person">
        by <span itemprop="name">Shelby Falde, Joshua Li, Alexander Chen</span>
      </span>

      <!-- <span>
        
      </span> -->
      <!--
      <span class="share-buttons">
        <span class="share-button"><a class="twitter-share-button" href="https://twitter.com/share" data-show-count="false">Tweet</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script></span>

        <span class="share-button"><span class="fb-like" data-href="/2025/12/12/team19-instruction-to-post.html" data-layout="button_count" data-action="like" data-size="small" data-show-faces="false" data-share="true"></span></span>
      </span>
      <div style="clear: both;"/>
      -->

    </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <blockquote>
  <p>This block is a brief introduction of your project. You can put your abstract here or any headers you want the readers to know.</p>
</blockquote>

<!--more-->
<ul id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li><a href="#planet-the-classification-approach-2016" id="markdown-toc-planet-the-classification-approach-2016">PlaNet: The Classification Approach (2016)</a>    <ul>
      <li><a href="#the-concept-of-geocells" id="markdown-toc-the-concept-of-geocells">The Concept of Geocells</a></li>
      <li><a href="#architecture-and-sequence-learning" id="markdown-toc-architecture-and-sequence-learning">Architecture and Sequence Learning</a></li>
    </ul>
  </li>
  <li><a href="#pigeon-the-semantic-shift-2023" id="markdown-toc-pigeon-the-semantic-shift-2023">PIGEON: The Semantic Shift (2023)</a>    <ul>
      <li><a href="#semantic-geocells" id="markdown-toc-semantic-geocells">Semantic Geocells</a></li>
      <li><a href="#haversine-smoothing-loss" id="markdown-toc-haversine-smoothing-loss">Haversine Smoothing Loss</a></li>
      <li><a href="#clip-pre-training--retrieval" id="markdown-toc-clip-pre-training--retrieval">CLIP Pre-training &amp; Retrieval</a></li>
      <li><a href="#results" id="markdown-toc-results">Results</a></li>
    </ul>
  </li>
  <li><a href="#basic-syntax" id="markdown-toc-basic-syntax">Basic Syntax</a>    <ul>
      <li><a href="#image" id="markdown-toc-image">Image</a></li>
      <li><a href="#table" id="markdown-toc-table">Table</a></li>
      <li><a href="#code-block" id="markdown-toc-code-block">Code Block</a></li>
      <li><a href="#formula" id="markdown-toc-formula">Formula</a></li>
      <li><a href="#more-markdown-syntax" id="markdown-toc-more-markdown-syntax">More Markdown Syntax</a></li>
    </ul>
  </li>
  <li><a href="#references" id="markdown-toc-references">References</a></li>
</ul>

<h2 id="introduction">Introduction</h2>

<p>Image geolocation is the task of predicting the geographic coordinates (latitude and longitude) of a given image. While humans rely on specific landmarks or cultural context, training a machine to recognize any location on Earth is a massive classification and regression challenge.</p>

<p>Early approaches relied on matching images to databases of landmarks, but these failed in “in the wild” scenarios where no distinct landmark is visible (e.g., a random road in rural Norway). Deep learning has since shifted this paradigm by learning global feature distributions and characteristics around the world.</p>

<p>In this survey, we explore how architectures have evolved from Convolutional Neural Networks (CNNs) to Transformers and CLIP-based models, specifically focusing on how they handle the partitioning of the Earth and the loss functions used to train them.</p>

<h2 id="planet-the-classification-approach-2016">PlaNet: The Classification Approach (2016)</h2>

<p>The pioneering paper <em>Photo Geolocation with Convolutional Neural Networks</em> [1], known as <em>PlaNet</em>, framed geolocation not as a regression problem (predicting raw coordinates), but as a classification problem.</p>

<h3 id="the-concept-of-geocells">The Concept of Geocells</h3>
<p>To treat the world as a classification target, PlaNet subdivides the Earth into discrete regions called <em>Geocells</em>.</p>

<p>However, a uniform grid doesn’t work well because photo distribution is not uniform since there are millions of photos of Paris, but very few of the middle of the ocean for example. PlaNet thus introduces <em>adaptive partitioning</em>:</p>

<ol>
  <li>Start with an S2 geometry grid.</li>
  <li>Recursively subdivide cells that contain too many photos.</li>
  <li>Stop when a cell reaches a target photo count.</li>
</ol>

<p>This results in a map where dense urban areas have tiny, precise cells, while oceans and deserts have massive cells.</p>

<p style="width: 800px; max-width: 100%;"><img src="/CS163-Projects-2025Fall/assets/images/team19/planet_geocells.png" alt="PlaNet Geocells" /></p>
<p><em>Fig 1. Adaptive partitioning of the world into Geocells based on photo density [1].</em></p>

<h3 id="architecture-and-sequence-learning">Architecture and Sequence Learning</h3>
<p>PlaNet utilizes an <em>Inception V3</em> architecture to classify images into one of these 26,263 geocells.</p>

<p>A key innovation in PlaNet was the use of <em>LSTMs (Long Short-Term Memory)</em> networks. Geolocation often happens in the context of a photo album. Knowing that the previous photo was taken at the Eiffel Tower heavily implies the current photo of a generic croissant is likely in Paris.</p>

<p>The model then outputs a probability distribution</p>

\[P(c_i | I)\]

<p>over all geocells using the features extracted by the CNN backbone.</p>

<h2 id="pigeon-the-semantic-shift-2023">PIGEON: The Semantic Shift (2023)</h2>

<p>The next leap forward comes from <em>PIGEON</em> (Pre-trained Image GEO-localization Network) [2]. This model was designed to compete against top human <em>GeoGuessr</em> players. Geoguessr is a popular browser game designed around humans guessing where you are in the world based on an image or 3D explorable space travelable via Google Streetview.</p>

<p style="width: 800px; max-width: 100%;"><img src="/CS163-Projects-2025Fall/assets/images/team19/pigeon_diagram.png" alt="Pigeon Geocells" /></p>
<p><em>Fig 2. Prediction pipeline and main contributions of PIGEON.</em></p>

<h3 id="semantic-geocells">Semantic Geocells</h3>
<p>PIGEON refines the geocell concept. While PlaNet split cells based purely on photo density, PIGEON incorporates <em>administrative boundaries</em>.</p>

<ul>
  <li><em>PlaNet:</em> Splits a cell if it has too many photos, regardless of borders.</li>
  <li><em>PIGEON:</em> Tries to respect country/region borders. This creates “Semantic Geocells,” preventing the model from confusing two neighboring countries that might look similar but have different road markings or signage.</li>
</ul>

<p style="width: 800px; max-width: 100%;"><img src="/CS163-Projects-2025Fall/assets/images/team19/naive_semantic_geocells.png" alt="Pigeon Diagram" /></p>
<p><em>Fig 3.      a) Old Naive geocells           b) Pigeon’s semantic geocells [2].</em></p>

<h3 id="haversine-smoothing-loss">Haversine Smoothing Loss</h3>
<p>A major limitation of PlaNet’s classification approach is that it penalizes “near misses” just as harshly as “far misses.” If the model guesses a cell 1km away from the correct one, standard One-Hot encoding treats it the same as guessing a cell on a different continent.</p>

<p>To fix this, PIGEON replaces standard labels with <em>Haversine Smoothing</em>. Instead of the correct cell being a <code class="language-plaintext highlighter-rouge">1</code> and all others <code class="language-plaintext highlighter-rouge">0</code>, neighboring cells get a partial label based on their physical distance to the image.</p>

<p>First, they define the <strong>Haversine Distance</strong> between two points \(\mathbf{p}_1\) and \(\mathbf{p}_2\) on Earth:</p>

\[\text{Hav}(\mathbf{p}_1, \mathbf{p}_2) = 2r \arcsin \left( \sqrt{\sin^2 \left( \frac{\phi_2 - \phi_1}{2} \right) + \cos(\phi_1) \cos(\phi_2) \sin^2 \left( \frac{\lambda_2 - \lambda_1}{2} \right)} \right)\]

<p>They then generate a “smoothed” label \(y_{n,i}\) for every geocell \(i\) relative to the true image location \(\mathbf{x}_n\). Cells closer to the true location receive a higher value:</p>

\[y_{n,i} = \exp \left( - \frac{\text{Hav}(\mathbf{g}_i, \mathbf{x}_n) - \text{Hav}(\mathbf{g}_n, \mathbf{x}_n)}{\tau} \right)\]

<p>Finally, the Loss Function \(\mathcal{L}_n\) minimizes the difference between the predicted probability \(p_{n,i}\) and this smoothed distance label:</p>

\[\mathcal{L}_n = - \sum_{g_i \in G} \log(p_{n,i}) \cdot y_{n,i}\]

<p>This ensures that the gradient penalty is lower if the model predicts a location that is geographically close to the target, effectively teaching the model a continuous topology of the Earth.</p>

<h3 id="clip-pre-training--retrieval">CLIP Pre-training &amp; Retrieval</h3>
<p>PIGEON utilizes <em>CLIP (Contrastive Language-Image Pre-training)</em> from OpenAI as its backbone. CLIP is trained on 400 million image-text pairs, so it already possesses a deep understanding of visual concepts, even before it is fine-tuned for location. It also introduces <em>intra-cell retrieval</em> to refine the exact location by looking up similar images within the predicted geocell.</p>

<h3 id="results">Results</h3>
<p>After several other finetuning features discussed in the paper but not here, <em>PIGEON</em> achieved landmark results and near pefect accuracy on country and continent classification:</p>

<p style="width: 800px; max-width: 100%;"><img src="/CS163-Projects-2025Fall/assets/images/team19/pigeon_results.png" alt="Pigeon Diagram" /></p>
<p><em>Fig 4. PIGEON Model results on a holdout dataset of 5,000 Street View locations.</em></p>

<p style="width: 800px; max-width: 100%;">While some may call the above results unimpressive, they then compare PIGEON’s results to ranked players on GeoGuessr to more fairly contextualize results:
<img src="/CS163-Projects-2025Fall/assets/images/team19/geoguessr_context.png" alt="GeoGuessr Context" /></p>
<p><em>Fig 4. PIGEON Model Comparison to Ranked GeoGuessr players. Champion Division being top 0.01% of all players.</em></p>

<h2 id="basic-syntax">Basic Syntax</h2>
<h3 id="image">Image</h3>
<p>Please create a folder with the name of your team id under /assets/images/, put all your images into the folder and reference the images in your main content.</p>

<p style="width: 400px; max-width: 100%;">You can add an image to your survey like this:
<img src="/CS163-Projects-2025Fall/assets/images/UCLAdeepvision/object_detection.png" alt="YOLO" /></p>
<p><em>Fig 1. YOLO: An object detection method in computer vision</em> [1].</p>

<p>Please cite the image if it is taken from other people’s work.</p>

<h3 id="table">Table</h3>
<p>Here is an example for creating tables, including alignment syntax.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left"> </th>
      <th style="text-align: center">column 1</th>
      <th style="text-align: right">column 2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">row1</td>
      <td style="text-align: center">Text</td>
      <td style="text-align: right">Text</td>
    </tr>
    <tr>
      <td style="text-align: left">row2</td>
      <td style="text-align: center">Text</td>
      <td style="text-align: right">Text</td>
    </tr>
  </tbody>
</table>

<h3 id="code-block">Code Block</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># This is a sample code block
import torch
print (torch.__version__)
</code></pre></div></div>

<h3 id="formula">Formula</h3>
<p>Please use latex to generate formulas, such as:</p>

\[\tilde{\mathbf{z}}^{(t)}_i = \frac{\alpha \tilde{\mathbf{z}}^{(t-1)}_i + (1-\alpha) \mathbf{z}_i}{1-\alpha^t}\]

<p>or you can write in-text formula \(y = wx + b\).</p>

<h3 id="more-markdown-syntax">More Markdown Syntax</h3>
<p>You can find more Markdown syntax at <a href="https://www.markdownguide.org/basic-syntax/">this page</a>.</p>

<h2 id="references">References</h2>

<p>[1] Weyand, Tobias, Ilya Kostrikov, and James Philbin. “Planet-photo geolocation with convolutional neural networks.” <em>European Conference on Computer Vision</em>. Springer, Cham, 2016.</p>

<p>[2] Haas, Lukas, et al. “PIGEON: Predicting Image Geolocations.” <em>arXiv preprint</em> arXiv:2307.05845, 2023. https://doi.org/10.48550/arXiv.2307.05845 (Accepted at CVPR 2024.)</p>

  </div>


  <!-- <div class="page-navigation">
    

    <!--  -->


  <!--comment-->
  
    <div id="disqus_thread"></div>
<script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://https-ucladeepvision-github-io.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

  

</article>

      </div>
    </main>

    <div style="clear: both;" />
<footer class="site-footer">
    2024 &copy; by UCLAdeepvision. All Rights Reserved. Built by <a href="https://jekyllrb.com/"
        target="_blank">Jekyll</a>

    <!-- <p>
        <a href="/CS163-Projects-2025Fall/feed.xml" target="_blank">
            <img src="/CS163-Projects-2025Fall/assets/images/logo_rss.png" />
        </a>
        <a href="https://scholar.google.com/citations?user=dCa-pW8AAAAJ&hl=en&oi=ao" target="_blank">
            <img src="/CS163-Projects-2025Fall/assets/images/logo_scholar.png" />
        </a>
        <a href="https://github.com/lilianweng" target="_blank">
            <img src="/CS163-Projects-2025Fall/assets/images/logo_github.png" />
        </a>
    </p> -->
</footer>

  </body>

</html>
