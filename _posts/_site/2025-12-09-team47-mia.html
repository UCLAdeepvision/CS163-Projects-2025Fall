<blockquote>
  <p>Memberhip Inference Attacks (MIA) are privacy attacks on machine learning models meant to predict whether or nota a data point was used to train a model. This blog looks at three different MIA methods against three different types of models.</p>
</blockquote>

<!--more-->
<ul id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li><a href="#convolutional-neural-networks-cnn" id="markdown-toc-convolutional-neural-networks-cnn">Convolutional Neural Networks (CNN)</a>    <ul>
      <li><a href="#target-model" id="markdown-toc-target-model">Target Model</a></li>
      <li><a href="#assumptions" id="markdown-toc-assumptions">Assumptions</a></li>
      <li><a href="#method" id="markdown-toc-method">Method</a></li>
      <li><a href="#results" id="markdown-toc-results">Results</a></li>
    </ul>
  </li>
  <li><a href="#contrastive-language-image-pretraining-clip" id="markdown-toc-contrastive-language-image-pretraining-clip">Contrastive Language-Image Pretraining (CLIP)</a>    <ul>
      <li><a href="#target-model-1" id="markdown-toc-target-model-1">Target Model</a></li>
      <li><a href="#assumptions-1" id="markdown-toc-assumptions-1">Assumptions</a></li>
      <li><a href="#method-1" id="markdown-toc-method-1">Method</a>        <ul>
          <li><a href="#cosine-similarity-attack-csa" id="markdown-toc-cosine-similarity-attack-csa">Cosine-Similarity Attack (CSA)</a></li>
          <li><a href="#augmentation-enhanced-attack-aea" id="markdown-toc-augmentation-enhanced-attack-aea">Augmentation-Enhanced Attack (AEA)</a></li>
          <li><a href="#weakly-supervised-attack-wsa" id="markdown-toc-weakly-supervised-attack-wsa">Weakly Supervised Attack (WSA)</a></li>
        </ul>
      </li>
      <li><a href="#results-1" id="markdown-toc-results-1">Results</a></li>
    </ul>
  </li>
  <li><a href="#diffusion" id="markdown-toc-diffusion">Diffusion</a>    <ul>
      <li><a href="#target-model-2" id="markdown-toc-target-model-2">Target Model</a></li>
      <li><a href="#assumptions-2" id="markdown-toc-assumptions-2">Assumptions</a></li>
      <li><a href="#method-2" id="markdown-toc-method-2">Method</a></li>
      <li><a href="#results-2" id="markdown-toc-results-2">Results</a></li>
    </ul>
  </li>
  <li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></li>
  <li><a href="#references" id="markdown-toc-references">References</a></li>
</ul>

<h1 id="introduction">Introduction</h1>

<p>With the widespread commercialization and use of machine learning and deep learning models, privacy risks have consequently become a rising concern. A Membership Inference Attack (MIA) is a form of privacy attack performed against a model to determine if a data point was used in training a specific model. In the context of computer vision and deep learning, these attacks are primarily concerned with whether or not a specific image was included in the training dataset. The basis for most MIA methods relies on the fact that machine learning models typically overfit to the training data. This discrepency between the model’s performance on the training data and unseen data exposes the model to such a privacy attack. Therefore, a successful MIA can expose vulnerabilities of a model, such as training data memorization, overfitting, and most importantly, data leakage. However, as models become more complex, robust, and diverse, various new methods are constantly being researched to improve the performance of these MIA attacks. This report aims to explore several Membership Inference Attack methods against three different types of models. Specifically, MIAs for Convolutional Neural Networks (CNN), Contrastive Language-Image Pretraining model (CLIP), and diffusion models will be discussed.</p>

<p>Membership is defined as being a part of, or a “member” of the training data. Essentially, if an image was used in the training data, that image is a member; on the other hand, if the image was not used for training, then the image is a non-member. Futhermore, a target model is defined as the model that is being attacked, while an attack model is a binary classification model used for predicting membership.</p>

<h1 id="convolutional-neural-networks-cnn">Convolutional Neural Networks (CNN)</h1>

<p>“Membership Inference Attacks Against Machine Learning Models” by Shokri et al. (2017)[4] is one of the most prominent and pioneering papers in this form of privacy attacks. Shokri et al. (2017) proposes an approach using shadow models to predict membership of images used to train convolutional neural networks (CNN).</p>

<h2 id="target-model">Target Model</h2>

<p>Although the paper utilizes various datasets, including tabular datasets, to keep it relevant to the course, this report will fous on the CIFAR datasets. For both the CIFAR-10 and CIFAR-100, a standard convolutional neural network (CNN) with two convolution and max pooling layers, a fully connected layer of size 128, a softmax layer, and Tanh activation was designed as the target model.</p>

<h2 id="assumptions">Assumptions</h2>

<p>The approach is based on the black-box assumption. This means that the attacker does not have access to any parameters of the target model, nor the actual training data itself. The only access provided is an auxiliary dataset (a dataset that has a similar statistical distribution to the real training data) and the output vector from the target model. This is crucial in cases where an attacker may only rely on a model’s API, rather than having access to the model itself, to query the output from an input image. In this specific paper, the attacker only relies on the softmax probabilities outputted from the target model, and nothing more.</p>

<h2 id="method">Method</h2>

<p>First, the auxiliiary dataset is obtained, whether this is through synthetic data or through real data. This data is assumed to be competely separate from the actual training data of the target model. The data is then bootstrapped into k different datasets. Each dataset is then split into a training and testing dataset. Using this data, k models of the same architecture as the target model are individually trained using their respective training data. These models are referred to as shadow models. After training, the ouputs from each shadow for their respective training and testing data are collected and concatenated with a corresponding label (1 if the data is a member and 0 if the data is a non-member). All the results are then split into separate datasets depending on the class label. For example, all data points with class label ‘airplane’ are combined into one dataset, all data points with class ‘bird’ are combined into another dataset, etc. For each dataset, the softmax probabilities are the features and its membership is the feature. Using this dataset, a completely new model–an attack model, is trained for each class label. The attack model takes the softmax probabilities as inputs to perform a binary classification task, determining whether the data is a member or a non-member.</p>

<p style="width: 400px; max-width: 100%;"><img src="/assets/images/team47/shokri3.png" alt="Shokri" /></p>
<p><em>Fig 1. Auxiliary data is used to train Shadow Models, which are used to train an Attack Model</em> [4].</p>

<p>Finally, once the attack model is trained, the target model is queried with the data in question to obtain its softmax probabilities. These probabilities are then fed into the corresponding attack model based on the predicted class label to classify membership.</p>

<p style="width: 400px; max-width: 100%;"><img src="/assets/images/team47/shokri1.png" alt="Shokri" /></p>
<p><em>Fig 2. The Attack model uses the Target model outputs to predict Membership</em> [4].</p>

<p>This attack method utilizes the over confidence of models on already seen data. Models are more likely to have higher confidence scores when predicting the class of an image they have been trained on, whereas they are more likely to be less confident in their predictions on unseen data. This discrepancy allows for a successful MIA.</p>

<h2 id="results">Results</h2>

<p style="width: 400px; max-width: 100%;"><img src="/assets/images/team47/shokri2.png" alt="Shokri" /></p>
<p><em>Fig 3. Precision for both CIFAR-10 and CIFAR-100 against the training data size</em> [4].</p>

<p>Precision was chosen as the metric to evaluate the performance of the MIA. Essentially, the propotion of actual members from the total number of images predicted as members were assessed. Looking at the figure above, it is evident that the precision was in fact very high for both the CIFAR-10 and CIFAR-100 datasets. The paper also mentions that recall was nearly 1.0 for both datasets.</p>

<p>The above results also demonstrate that the attack performs better on the CIFAR-100 dataset than the CIFAR-10 dataset. Based on this, it can be inferred that more classes contribute to more leakage. Because the attack model relies on the probability vector of the target model, more classes allows the attack model to have more information about the target model. This in turn helps the attack model perform better.</p>

<h1 id="contrastive-language-image-pretraining-clip">Contrastive Language-Image Pretraining (CLIP)</h1>

<p>“Practical Membership Inference Attacks Against Large-Scale Multi-Modal Models: A Pilot Study” by Ko et al. (2023) dives into attacking self-supervised vision language models, specifically the CLIP model.</p>

<h2 id="target-model-1">Target Model</h2>

<p>The CLIP model utilizes two different encoders: one for images and one for text. Using these images, the CLIP model learns to connect matching images with the corresponding text. The model uses contrastive learning, which utilizes cosine similarity to maximize the similarity between correct image-text pairs while minimizing the similarity between incorrect image-text pairs.</p>

<p style="width: 400px; max-width: 100%;"><img src="/assets/images/team47/clip.svg" alt="OpenAI" /></p>
<p><em>Fig 4. CLIP model</em> [3].</p>

<p>For the image backbone of the target CLIP models, ViT-B/32, ViT-B/16, and ViT-L/14 are used for the LAION dataset while ResNet50, Resnet101, and ViT-B/32 are used for the CC12M dataset.</p>

<h2 id="assumptions-1">Assumptions</h2>

<p>Similar to the first paper, black-box access is assumed in this research as well. The attacker is able to query the model with a pair of image and text, and obtain the corresponding encoded features. It is assumed that the attacker is unaware of the model architecture, parameters, etc. The first two attack methods also assume that the attacker has no knowledge on the real training dataset.</p>

<h2 id="method-1">Method</h2>

<p>The paper proposes three different methods in this paper.</p>

<h3 id="cosine-similarity-attack-csa">Cosine-Similarity Attack (CSA)</h3>

<p>This attack relies on the basis that models trained with constrastive learning focus on maximizing cosine similarity. In this simple attack, the cosine similarity scores are compared using a threshold. The cosine similarity between the image and its respective text is calculated. If this score is above a certain, predefined threshold, then the data is predicted to be a member, and vice versa.</p>

<h3 id="augmentation-enhanced-attack-aea">Augmentation-Enhanced Attack (AEA)</h3>

<p>In this second attack, K number of transformations are performed on each input image. Then, the cosine similarity between the text and the transformed image are calculated, and the cosine similarity gap, or the difference in cosine similiarity from the original image and the text are collected. Finally, these scores are aggregated and compared to a threshold to determine membership. Similar to the previous attack, if the scores exceed the threshold, they are considered a member, and vice versa.</p>

<h3 id="weakly-supervised-attack-wsa">Weakly Supervised Attack (WSA)</h3>

<p>The Weakly Supervised Attack is the most promising attack proposed in this paper. However, this method relies on a different assumption regarding the data compared to the last two attacks. When attacking models trained on public, internet data, it can be easily assumed that data uploaded after the publication of the model are definitely non-members. Using this knowledge, the mean and standard deviation of the cosine similarities of the model outputs on these guaranteed non-members are calculated. Then, from a very large dataset containing both non-members and members, data whose cosine similarities are greater than $\mu_{no} + \lambda \sigma_{no}$, where $\mu_{no}$ is the mean of the non-member data and $\sigma_{no}$ is the standard deviation of the non-member data, are collected as pseudo-members. It is assumed that image-text pairs with a much higher cosine similarity are outliers, and therefore can be excluded from being a non-member. The encoded features for the images and texts for both psuedo-members and non-members, along with their corresponding binary labels (1 for member and 0 for non-member) are used to create an attack dataset. An attack model, similar to Shokri et al., is then trained using this data to predict binary membership.</p>

<p style="width: 400px; max-width: 100%;"><img src="/assets/images/team47/ko1.png" alt="Ko" /></p>
<p><em>Fig 5. An Overview of the proposed Weakly Supervised Attack</em> [1].</p>

<h2 id="results-1">Results</h2>

<p>The table below shows the <strong>AUC</strong> for each attack method on each model for the <strong>LAION</strong> dataset:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Method</th>
      <th style="text-align: center">ViT-B/32</th>
      <th style="text-align: right">ViT-B/16</th>
      <th style="text-align: right">ViT-L/4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">CSA</td>
      <td style="text-align: center">0.75</td>
      <td style="text-align: right">0.76</td>
      <td style="text-align: right">0.79</td>
    </tr>
    <tr>
      <td style="text-align: left">AEA</td>
      <td style="text-align: center">0.76</td>
      <td style="text-align: right">0.79</td>
      <td style="text-align: right">0.80</td>
    </tr>
    <tr>
      <td style="text-align: left">WSA</td>
      <td style="text-align: center">0.92</td>
      <td style="text-align: right">0.93</td>
      <td style="text-align: right">0.94</td>
    </tr>
  </tbody>
</table>

<p>The table below shows the <strong>AUC</strong> for each attack method on each model for the <strong>CC12M</strong> dataset:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Method</th>
      <th style="text-align: center">ResNet50</th>
      <th style="text-align: right">Resnet101</th>
      <th style="text-align: right">ViT-B/32</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">CSA</td>
      <td style="text-align: center">0.67</td>
      <td style="text-align: right">0.69</td>
      <td style="text-align: right">0.70</td>
    </tr>
    <tr>
      <td style="text-align: left">AEA</td>
      <td style="text-align: center">0.74</td>
      <td style="text-align: right">0.73</td>
      <td style="text-align: right">0.71</td>
    </tr>
    <tr>
      <td style="text-align: left">WSA</td>
      <td style="text-align: center">0.79</td>
      <td style="text-align: right">0.82</td>
      <td style="text-align: right">0.79</td>
    </tr>
  </tbody>
</table>

<p>The results above show that even the simplest cosine similarity attack demonstrates high performance on the CLIP models. However, the proposed Weakly Supervised Attack demonstrates an exceptionally high improvement and performance, especially for the LAION dataset.</p>

<p>Cosine similarity alone may not be enough to clearly separate member data points from non-member data points. On the other hand, because the WSA method trains an attack classifier on the features, it can be regarded as a much more complex transformation. This allows the approach to extract more meaningful relationships and separate members from non-members better, as shown through the higher performance.</p>

<h1 id="diffusion">Diffusion</h1>

<p>“Towards Black-Box Membership Inference Attack for Diffusion Models” proposes a novel method for performing MIAs on various forms of diffusion models. In particular, the proposed method is compatible with just black-box access by not relying on the U-net architecture like other pre-existing approaches.</p>

<h2 id="target-model-2">Target Model</h2>

<p>This paper chooses to attack several different variations of diffusion models. In particular, the DDIM model, diffusion transformer model, stable diffusion model are tested. In addition to these three models, the DALL-E 2 is also attacked using its API.</p>

<h2 id="assumptions-2">Assumptions</h2>

<p>This research also assumes black-box access. The attack proposed relies only on the target model’s API and does not have access to any internal structure or parameters.</p>

<h2 id="method-2">Method</h2>

<p>This attack method is designed on the basis that images used in training are more likely to undergo minimal changes when inputted through the diffusion process, while unseen, non-member images are more likely to undergo larger changes.</p>

<p>For every image, the attacker inputs the image to the selected model and repeats this several times. Each time, the model takes in the same input image, adds noise to the image, then denoises the image, and finally outputs a newly generated image. The attacker then takes the newly generated images (of the same input image) and averages the images together. The difference between this average and the original image is calculated, and if this difference is below a certain threshold, the input image is determined to be a member.</p>

<p style="width: 400px; max-width: 100%;"><img src="/assets/images/team47/li.png" alt="Li" /></p>
<p><em>Fig 6. An Overview of the proposed ReDiffuse algorithm</em> [2].</p>

<h2 id="results-2">Results</h2>

<p>The results for each model is shown below:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Metric</th>
      <th style="text-align: center">DDIM</th>
      <th style="text-align: right">Diffusion Transformer</th>
      <th style="text-align: right">Stable Diffusion</th>
      <th style="text-align: right">DALLE-2 (with L1 distance)</th>
      <th style="text-align: right">DALLE-2 (with L2 distance)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">AUC</td>
      <td style="text-align: center">0.96</td>
      <td style="text-align: right">0.98</td>
      <td style="text-align: right">0.81</td>
      <td style="text-align: right">76.2</td>
      <td style="text-align: right">88.3</td>
    </tr>
    <tr>
      <td style="text-align: left">ASR</td>
      <td style="text-align: center">0.91</td>
      <td style="text-align: right">0.95</td>
      <td style="text-align: right">0.75</td>
      <td style="text-align: right">74.5</td>
      <td style="text-align: right">81.4</td>
    </tr>
  </tbody>
</table>

<p>As shown above, the proposed attack demonstrates very high performance for all the diffusion models, validating an effective MIA. The attack’s performance on the DALLE-2 provides important insight that even popular, commercialized models can be vulnerable to privacy attacks and data leakage.</p>

<h1 id="conclusion">Conclusion</h1>

<p>This blog explored three different methods for performing MIA against three different models. This demonstrates how custom methods for attacking different types of models are necessary for good performance. Overall, it is evident that the proposed methods are all very successful in performing strong attacks against their respective target models. These results leave great concerns regarding privacy risks in vision deep learning models, along with great potential for further research into defenses against such privacy attacks.</p>

<h1 id="references">References</h1>

<p>[1] Ko, Myeongseob, et al. “Practical membership inference attacks against large-scale multi-modal models: A pilot study.” arXiv preprint arXiv:2310.00108, 2023.</p>

<p>[2] Li, Jingwei, et al. “Towards black-box membership inference attack for Diffusion Models.” arXiv preprint arXiv:2405.20771, 2024.</p>

<p>[3] OpenAI, “CLIP: Connecting Text and Images,” OpenAI Blog.[Online]. Available: https://openai.com/index/clip/</p>

<p>[4] Shokri, Reza, et al. “Membership inference attacks against Machine Learning Models.” arXiv preprint arXiv:1610.05820, 2017.</p>
